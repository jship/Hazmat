FUNCTION(ADD_TEST_APP TARGET HEADERS SOURCES DEPENDENCIES DATA)
    ADD_EXECUTABLE(${TARGET} ${HEADERS} ${SOURCES} ${DATA} ${ARGN})
	TARGET_LINK_LIBRARIES(${TARGET} ${DEPENDENCIES})

    INSTALL(TARGETS ${TARGET} RUNTIME DESTINATION bin)
    
    FOREACH(DATA_ITEM ${DATA})
        GET_FILENAME_COMPONENT(DATA_ITEM_EXT ${DATA_ITEM} EXT)
        IF ("${DATA_ITEM_EXT}" STREQUAL "")
            INSTALL(DIRECTORY ${DATA_ITEM} DESTINATION bin)
        ELSE()
            INSTALL(FILES ${DATA_ITEM} DESTINATION bin)
        ENDIF()
    ENDFOREACH()
ENDFUNCTION(ADD_TEST_APP)
